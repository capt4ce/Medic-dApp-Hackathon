Web3 = require('web3')
config = require('./config.js')

contractAddress = '0x43f472684368e2051bdfbb230d3ba104ecd9409f'
abi = JSON.parse('[{"constant":false,"inputs":[{"name":"patient","type":"address"}],"name":"getPatientRenalProfile","outputs":[{"components":[{"name":"Creatinine","type":"uint8"},{"name":"Sodium","type":"uint8"},{"name":"Potassium","type":"uint8"},{"name":"eGFR","type":"uint8"},{"name":"Urea","type":"uint8"}],"name":"","type":"tuple"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"diseaseHash","type":"string"},{"name":"name","type":"string"},{"name":"symptomList","type":"string"}],"name":"getDiseaseDetail","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"patient","type":"address"},{"name":"sex","type":"string"}],"name":"changePatientSex","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"patient","type":"address"},{"name":"age","type":"uint8"}],"name":"changePatientAge","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"doctor","type":"address"}],"name":"getDoctorDetail","outputs":[{"components":[{"name":"identityHash","type":"string"},{"name":"age","type":"uint8"},{"name":"sex","type":"string"},{"name":"specialities","type":"string"}],"name":"","type":"tuple"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"patient","type":"address"}],"name":"getPatientDetail","outputs":[{"name":"","type":"string"},{"name":"","type":"uint8"},{"name":"","type":"string"},{"name":"","type":"string"},{"name":"","type":"string"},{"name":"","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"age","type":"uint8"}],"name":"changeAge","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"patient","type":"address"},{"name":"Creatinine","type":"uint8"},{"name":"Sodium","type":"uint8"},{"name":"Potassium","type":"uint8"},{"name":"eGFR","type":"uint8"},{"name":"Urea","type":"uint8"}],"name":"setPatientRenalProfile","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"patient","type":"address"},{"name":"treatments","type":"string"},{"name":"treatmentStatus","type":"string"},{"name":"disease","type":"string"}],"name":"issueTreatmentRecord","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"drugHash","type":"string"}],"name":"drugBuy","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"patient","type":"address"},{"name":"currentDiseases","type":"string"}],"name":"changePatientCurrentDiseases","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"patient","type":"address"},{"name":"treatmentRestrictions","type":"string"}],"name":"changePatientTreatmentRestrictions","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"diseaseHash","type":"string"},{"name":"name","type":"string"},{"name":"symptomList","type":"string"}],"name":"addDisease","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"identityHash","type":"string"},{"name":"age","type":"uint8"},{"name":"sex","type":"string"},{"name":"specialities","type":"string"}],"name":"addDoctor","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"patient","type":"address"},{"name":"currentTreatments","type":"string"}],"name":"changePatientCurrentTreatments","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"specialities","type":"string"}],"name":"changeSpecialities","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"drugHash","type":"string"},{"name":"name","type":"string"},{"name":"qty","type":"int256"},{"name":"price","type":"uint8"}],"name":"sellDrug","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"identityHash","type":"string"},{"name":"age","type":"uint8"},{"name":"sex","type":"string"},{"name":"currentDiseases","type":"string"},{"name":"currentTreatments","type":"string"},{"name":"treatmentRestrictions","type":"string"}],"name":"addPatient","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"sex","type":"string"}],"name":"changeSex","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"test","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"doctor","type":"address"},{"indexed":false,"name":"patient","type":"address"},{"indexed":false,"name":"treatments","type":"string"},{"indexed":false,"name":"status","type":"string"},{"indexed":false,"name":"disease","type":"string"}],"name":"Treatment","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"patient","type":"address"},{"indexed":false,"name":"Creatinine","type":"uint8"},{"indexed":false,"name":"Sodium","type":"uint8"},{"indexed":false,"name":"Potassium","type":"uint8"},{"indexed":false,"name":"eGFR","type":"uint8"},{"indexed":false,"name":"Urea","type":"uint8"}],"name":"RenalTest","type":"event"}]')

web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));

contract = web3.eth.contract(abi);
contractInstance = contract.at(contractAddress);

// vote = contractInstance.Vote({}, { fromBlock: 3, toBlock: 'latest' })
// vote.watch(function (e, r) {
//   // console.log(r)
//   console.log('name: ' + web3.toAscii(r.args.name))
//   console.log('voter: ' + r.args.voter)
// })

console.log(contractInstance.getPatientDetail.call('0xc3d0d958e12c2db3b2735338376f9c4f3480432a'))
// console.log(contractInstance.getDoctorDetail.call('0xbda80a2451103e1d2c7556f371e4c5ed1c0a51f7'))
// console.log(contractInstance.patient.call(function (e, r) {
//     console.log(r)
// }))


// filter = contractInstance.Treatment({}, { fromBlock: 0, toBlock: 'latest' });
// filter.watch(function (e, r) {
//     console.log(e)
// })
